# 使用方法
基于通用性考虑， 本项目通过命令行使用。 因此，你可以把本项目嵌入到你的服务器中，也可以嵌入到任何地方。

## 1. 创建角色
----
```
$ chatbot create
```
运行命令后，  
输入你的角色文本即可。  
一个角色文本可以是：  
1. 一段角色设定文字。  
2. 一个json文件，包含一个object， 形式如下:
```
{
    "role-setting": ".....", // 机器人设定
    // facts的说明：未来可以支持某个url， 这个url可以是普通网页，也可以是pdf，甚至是某个docx附件， 某个托管在互联网上的“文件夹”， 某个互联网上的zip文件。从而用户可以把自己的文件夹压缩后，上传到某个托管站点， 然后通过指定facts， 即可。
    "facts": "...." // 机器人需要知道的事实性知识。(可选)
}
```
3. 一个python项目， 必须包含一个completion函数:(TODO: 研究python以什么形式打包，供别人调用？)
```
    completion(prompt)==>new-prompt
```
开发者可以在这个函数里， 发起多个openai请求， 记录重要信息， 甚至升级“事实”， 升级这个角色自身等等。
- 记录用户的重要信息： 开发者可以使用mongodb的数据修改语句， 来修改“角色”或者“角色-用户”的记忆。
- 升级角色自身： 开发者可以通过调用"chatbot update <roleid> new-python-role.py"来升级自身。

事实上， 前两种文本方式，在chatbot项目内部，都会被统一包装成第三种形式, 也就是说， chatbot会为前两种方式的“角色”生成一个python格式的角色。 并且在内部统一使用python格式的角色。

当然， 你也可以使用shell的输入重定向， 来把你的“文件”导入成角色。
```
$ chatbot create < py-coach.json
```

## 2. update 角色
----
```
$ chatbot update <role-id>
```
输入内容同上。只是把新的role覆盖掉老的role而已。

## 3. introduce 角色
---
```
$ chatbot introduce <role-id>
```
输出这个role本身。


## 4. 和角色对话
----
```
$ chatbot talk from-user-id to-role-id
```
输入之前的聊天对话历史， 直到最后一句是用户发起的。  
其中，如果`<from-user-id>`为0， 表示匿名用户。  
程序应该输出补全的部分。  
例如:  

输入：
```
$ chatbot talk 123 111
123: 你好
111: 你好呀， 我是考级助手。 可以辅助你刷题， 你想开始吗？还是有其他问题想讨论？
123: 请给我一道题目
```

输出：
```
111: 输入一个整数n， 输出1~n之间的奇数。
```

# 运行时环境
开发者的代码在执行时， 可以`import context`  
这包括：
1. db: 一个mongodb数据库, 使用monger库来访问。(TODO: 待研究)
2. user-id: 聊天的用户id。 如果为空，则为匿名用户。
